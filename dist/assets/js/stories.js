(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';

var _theme = require('./util/theme.js');

var _theme2 = _interopRequireDefault(_theme);

var _stories = require('./util/stories.js');

var _stories2 = _interopRequireDefault(_stories);

var _cat = require('./util/cat.js');

var _cat2 = _interopRequireDefault(_cat);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var a = axios.create({
	// baseURL: window._burl // set in HTML via wordpress
	baseURL: 'http://doe.concordia.ca/cslp/wp-json/wp/v2/' // development
});

var toggle = document.getElementById('a');
var themesToggled = !toggle.checked;

// app state
var state = {};
state.drillLevel = 0;
state.active = 'none';
state.levelstring = '';
state.themeID = null; // for further caching. Implement later!
state.backone = function () {
	this.drillLevel -= 1;
	console.log('state.drillLevel: ', state.drillLevel);
};
state.hidemeta = function () {
	document.querySelectorAll('.stories-meta')[0].className = 'stories-meta hidden';
};

var themesContainer = document.getElementById('stories__by-theme');
var categsContainer = document.getElementById('stories__by-cat');
var themeItems = themesContainer.querySelectorAll('.theme-card');
var categItems = categsContainer.querySelectorAll('.category-card');
document.getElementById('cat-meta').className = 'hidden';
document.getElementById('theme-meta').className = 'hidden';

var d = document.getElementById('drilldown');

// Add toggle evntlist
toggle.addEventListener('click', function () {
	themesToggled = !toggle.checked;
	if (!themesToggled) {
		themesContainer.className = 'selected';
		categsContainer.className = '';
	} else {
		themesContainer.className = '';
		categsContainer.className = 'selected';
	}

	document.getElementById('cat-meta').className = 'hidden';
	document.getElementById('theme-meta').className = 'hidden';
	document.getElementById('story').className = 'hidden';
});

if (!themesToggled) {
	themesContainer.className = 'selected';
	categsContainer.className = '';
} else {
	themesContainer.className = '';
	categsContainer.className = 'selected';
}

// implement the logic on each Theme item
themeItems.forEach(function (item) {
	item.addEventListener('click', function (e) {
		e.preventDefault();
		var ID = item.getAttribute('data-theme');

		if (!_theme2.default.isCached(ID)) {
			// if not cached, check online
			_theme2.default.get(ID, a, function (data) {
				console.log('retrieved live data: ID #' + ID);
				_theme2.default.setDOM(data, state, _stories2.default, a);
			});
		} else {
			var data = JSON.parse(localStorage.getItem('t' + ID));
			console.log('retrieved cached data: ID #' + ID);
			_theme2.default.setDOM(data, state, _stories2.default, a);
		}

		themesContainer.className = ''; // hide theme list
		d.setAttribute('data-active', 'theme');
	});
});

// implement the logic on each Category Item
categItems.forEach(function (item) {
	item.addEventListener('click', function (e) {
		e.preventDefault();
		var ID = item.getAttribute('data-cat');

		if (!_cat2.default.isCached(ID)) {
			_cat2.default.get(ID, a, function (data) {
				console.log('retrieved live data: ID #' + ID);
				state.levelstring = 'By category > ' + data.name;
				_cat2.default.setDOM(data, state, _stories2.default, a);
			});
		} else {
			var data = JSON.parse(localStorage.getItem('c' + ID));
			console.log('retrieved cached data: ID #' + ID);
			state.levelstring = 'By category > ' + data.name;
			_cat2.default.setDOM(data, state, _stories2.default, a);
		}
		categsContainer.className = '';
		d.setAttribute('data-active', 'cat');
	});
});

},{"./util/cat.js":2,"./util/stories.js":3,"./util/theme.js":4}],2:[function(require,module,exports){
'use strict';

module.exports = {
	isCached: function isCached(ID) {
		return localStorage.getItem('c' + ID) ? true : false;
	},

	cache: function cache(data) {
		localStorage.setItem('c' + data.id, JSON.stringify(data));
	},

	get: function get(catID, axios, callback) {
		var _this = this;

		axios.get('categories/' + catID).then(function (response) {
			_this.cache(response.data);
			callback(response.data);
		}).catch('error', function (error) {
			console.warn(error);
			return null;
		});
	},

	setDOM: function setDOM(cat, state, story, axios) {
		// set the element to visible
		//
		var c = document.getElementById('cat-meta');
		state.drillLevel = 1; // not implemented
		document.getElementById('cat-meta').className = '';
		document.getElementById('theme-meta').className = 'hidden';
		document.getElementById('story').className = 'hidden';

		console.log('state: ', state);

		// set meta description
		c.querySelectorAll('#cat-meta__header h2')[0].innerHTML = cat.name;
		c.querySelectorAll('#cat-meta__header span')[0].innerHTML = state.levelstring;
		document.getElementById('cat-meta__content').innerHTML = cat.description;

		// set async
		setTimeout( //  + '&fields=id,title,stories_description' :(
		story.getRelatedStories('story?categories=' + cat.id, function (stories) {
			var list = document.getElementById('cat-meta__list');
			list.className = 'isRefreshing';
			list.innerHTML = '';

			// create story previews

			var _loop = function _loop() {
				var s = stories[i];

				var el = document.createElement('div');
				el.className = 'story';
				el.setAttribute('data-story', s.id);
				el.innerHTML = '<h3>' + s.title.rendered + '</h3>' + '<p>' + s.stories_description + '</p>' + '<p class="meta"><b>Level:</b> ' + story.level(s.story_level) + '</p>';

				document.getElementById('cat-meta__list').appendChild(el);

				el.addEventListener('click', function () {
					location.href = s.link;
				});
			};

			for (var i = stories.length - 1; i >= 0; i--) {
				_loop();
			}
			list.className = '';
		}, axios), 0);
	}
};

},{}],3:[function(require,module,exports){
'use strict';

module.exports = {
	// Story Functions
	getRelatedStories: function getRelatedStories(query, callback, axios) {
		axios.get(query).then(function (res) {
			callback(res.data);
		}).catch('error', function (e) {
			console.warn(e);
		});
	},

	showStory: function showStory(story, state) {
		document.getElementById('cat-meta').className = 'hidden';
		document.getElementById('theme-meta').className = 'hidden';

		var s = document.getElementById('story');
		s.className = '';
		document.getElementById('story-title').innerHTML = story.title.rendered;
		s.querySelectorAll('header span')[0].innerHTML = state.levelstring + ' > ' + story.title.rendered;

		document.getElementById('story__body-desc').innerHTML = story.stories_description;
		document.getElementById('story__body-res').innerHTML = story.stories_resources;

		// let res = []
		// let resHTML = '<ul>'
		// document.getElementById('story__body-links').innerHTML = story.resHTML

		console.log('story: ', story);
	},

	/**
  * Returns the strig associated with each level
  * @param  {int} int [the story's level]
  * @return {string}  [corresponding level]
  */
	level: function level(int) {
		var i = parseInt(int);
		switch (i) {
			case 1:
				return 'Beginner';
			case 2:
				return 'Easy';
			case 3:
				return 'Average';
			case 4:
				return 'Advanced';
			case 5:
				return 'Expert';
		}
	}
};

},{}],4:[function(require,module,exports){
'use strict';

// theme functions
module.exports = {

	isCached: function isCached(ID) {
		return localStorage.getItem('t' + ID) ? true : false;
	},

	cache: function cache(data) {
		localStorage.setItem('t' + data.id, JSON.stringify(data));
	},

	get: function get(themeID, axios, callback) {
		var _this = this;

		axios.get('tags/' + themeID).then(function (response) {
			_this.cache(response.data);
			callback(response.data);
		}).catch('error', function (error) {
			console.warn(error);
			return null;
		});
	},

	setDOM: function setDOM(theme, state, story, axios) {
		// set the element to visible
		var t = document.getElementById('theme-meta');
		state.drillLevel = 1; // not implemented
		document.getElementById('cat-meta').className = 'hidden';
		document.getElementById('theme-meta').className = '';
		document.getElementById('story').className = 'hidden';

		// set meta description
		t.querySelectorAll('#theme-meta__header h2')[0].innerHTML = theme.name;
		t.querySelectorAll('#theme-meta__header span')[0].innerHTML = state.levelstring;
		document.getElementById('theme-meta__content').innerHTML = theme.description;

		// set async
		setTimeout( //  + '&fields=id,title,stories_description' :(
		story.getRelatedStories('story?tags=' + theme.id, function (stories) {
			var list = document.getElementById('theme-meta__list');
			list.className = 'isRefreshing';
			list.innerHTML = '';

			// create story previews

			var _loop = function _loop() {
				var s = stories[i];

				var el = document.createElement('div');
				el.className = 'story';
				el.setAttribute('data-story', s.id);
				el.innerHTML = '<h3>' + s.title.rendered + '</h3>' + '<p>' + s.stories_description + '</p>' + '<p class="meta"><b>Level:</b> ' + story.level(s.story_level) + '</p>';

				document.getElementById('theme-meta__list').appendChild(el);

				el.addEventListener('click', function () {
					// story.showStory(s, state)
					location.href = s.link;
				});
			};

			for (var i = stories.length - 1; i >= 0; i--) {
				_loop();
			}
			list.className = '';
		}, axios), 0);
	}
};

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvc2NyaXB0cy9zdG9yaWVzL3N0b3JpZXMuanMiLCJzcmMvc2NyaXB0cy9zdG9yaWVzL3V0aWwvY2F0LmpzIiwic3JjL3NjcmlwdHMvc3Rvcmllcy91dGlsL3N0b3JpZXMuanMiLCJzcmMvc2NyaXB0cy9zdG9yaWVzL3V0aWwvdGhlbWUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTs7QUFFQTs7OztBQUNBOzs7O0FBQ0E7Ozs7OztBQUVBLElBQU0sSUFBSSxNQUFNLE1BQU4sQ0FBYTtBQUN0QjtBQUNBLFVBQVMsNkNBRmEsQ0FFaUM7QUFGakMsQ0FBYixDQUFWOztBQUtBLElBQU0sU0FBUyxTQUFTLGNBQVQsQ0FBd0IsR0FBeEIsQ0FBZjtBQUNBLElBQUksZ0JBQWdCLENBQUMsT0FBTyxPQUE1Qjs7QUFFQTtBQUNBLElBQU0sUUFBUSxFQUFkO0FBQ0EsTUFBTSxVQUFOLEdBQW1CLENBQW5CO0FBQ0EsTUFBTSxNQUFOLEdBQWUsTUFBZjtBQUNBLE1BQU0sV0FBTixHQUFvQixFQUFwQjtBQUNBLE1BQU0sT0FBTixHQUFnQixJQUFoQixDLENBQXFCO0FBQ3JCLE1BQU0sT0FBTixHQUFnQixZQUFZO0FBQzNCLE1BQUssVUFBTCxJQUFtQixDQUFuQjtBQUNBLFNBQVEsR0FBUixDQUFZLG9CQUFaLEVBQWtDLE1BQU0sVUFBeEM7QUFDQSxDQUhEO0FBSUEsTUFBTSxRQUFOLEdBQWlCLFlBQVk7QUFDNUIsVUFBUyxnQkFBVCxDQUEwQixlQUExQixFQUEyQyxDQUEzQyxFQUE4QyxTQUE5QyxHQUEwRCxxQkFBMUQ7QUFDQSxDQUZEOztBQUlBLElBQU0sa0JBQWtCLFNBQVMsY0FBVCxDQUF3QixtQkFBeEIsQ0FBeEI7QUFDQSxJQUFNLGtCQUFrQixTQUFTLGNBQVQsQ0FBd0IsaUJBQXhCLENBQXhCO0FBQ0EsSUFBTSxhQUFhLGdCQUFnQixnQkFBaEIsQ0FBaUMsYUFBakMs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QWlCLEVBQWpCOztBQUVBOztBQUxvRTtBQU9uRSxRQUFJLElBQUksUUFBUSxDQUFSLENBQVI7O0FBRUEsUUFBSSxLQUFLLFNBQVMsYUFBVCxDQUF1QixLQUF2QixDQUFUO0FBQ0EsT0FBRyxTQUFILEdBQWUsT0FBZjtBQUNBLE9BQUcsWUFBSCxDQUFnQixZQUFoQixFQUE4QixFQUFFLEVBQWhDO0FBQ0EsT0FBRyxTQUFILEdBQWUsU0FBUyxFQUFFLEtBQUYsQ0FBUSxRQUFqQixHQUE0QixPQUE1QixHQUNiLEtBRGEsR0FDTCxFQUFFLG1CQURHLEdBQ21CLE1BRG5CLEdBRWIsZ0NBRmEsR0FFc0IsTUFBTSxLQUFOLENBQVksRUFBRSxXQUFkLENBRnRCLEdBRW1ELE1BRmxFOztBQUlBLGFBQVMsY0FBVCxDQUF3QixrQkFBeEIsRUFBNEMsV0FBNUMsQ0FBd0QsRUFBeEQ7O0FBRUEsT0FBRyxnQkFBSCxDQUFvQixPQUFwQixFQUE2QixZQUFNO0FBQ2xDO0FBQ0EsY0FBUyxJQUFULEdBQWdCLEVBQUUsSUFBbEI7QUFDQSxLQUhEO0FBbEJtRTs7QUFNcEUsUUFBSyxJQUFJLElBQUksUUFBUSxNQUFSLEdBQWlCLENBQTlCLEVBQWlDLEtBQUssQ0FBdEMsRUFBeUMsR0FBekMsRUFBOEM7QUFBQTtBQWdCN0M7QUFDRCxRQUFLLFNBQUwsR0FBaUIsRUFBakI7QUFDQSxHQXhCRCxFQXdCRyxLQXhCSCxDQURELEVBMEJHLENBMUJIO0FBMkJBO0FBN0RlLENBQWpCIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgdGhlbWUgZnJvbSAnLi91dGlsL3RoZW1lLmpzJ1xuaW1wb3J0IHN0b3J5IGZyb20gJy4vdXRpbC9zdG9yaWVzLmpzJ1xuaW1wb3J0IGNhdGVnIGZyb20gJy4vdXRpbC9jYXQuanMnXG5cbmNvbnN0IGEgPSBheGlvcy5jcmVhdGUoe1xuXHQvLyBiYXNlVVJMOiB3aW5kb3cuX2J1cmwgLy8gc2V0IGluIEhUTUwgdmlhIHdvcmRwcmVzc1xuXHRiYXNlVVJMOiAnaHR0cDovL2RvZS5jb25jb3JkaWEuY2EvY3NscC93cC1qc29uL3dwL3YyLycgLy8gZGV2ZWxvcG1lbnRcbn0pXG5cbmNvbnN0IHRvZ2dsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhJylcbmxldCB0aGVtZXNUb2dnbGVkID0gIXRvZ2dsZS5jaGVja2VkXG5cbi8vIGFwcCBzdGF0ZVxuY29uc3Qgc3RhdGUgPSB7fVxuc3RhdGUuZHJpbGxMZXZlbCA9IDBcbnN0YXRlLmFjdGl2ZSA9ICdub25lJ1xuc3RhdGUubGV2ZWxzdHJpbmcgPSAnJ1xuc3RhdGUudGhlbWVJRCA9IG51bGwgLy8gZm9yIGZ1cnRoZXIgY2FjaGluZy4gSW1wbGVtZW50IGxhdGVyIVxuc3RhdGUuYmFja29uZSA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5kcmlsbExldmVsIC09IDFcblx0Y29uc29sZS5sb2coJ3N0YXRlLmRyaWxsTGV2ZWw6ICcsIHN0YXRlLmRyaWxsTGV2ZWwpXG59XG5zdGF0ZS5oaWRlbWV0YSA9IGZ1bmN0aW9uICgpIHtcblx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnN0b3JpZXMtbWV0YScpWzBdLmNsYXNzTmFtZSA9ICdzdG9yaWVzLW1ldGEgaGlkZGVuJ1xufVxuXG5jb25zdCB0aGVtZXNDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3Rvcmllc19fYnktdGhlbWUnKVxuY29uc3QgY2F0ZWdzQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0b3JpZXNfX2J5LWNhdCcpXG5jb25zdCB0aGVtZUl0ZW1zID0gdGhlbWVzQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy50aGVtZS1jYXJkJylcbmNvbnN0IGNhdGVnSXRlbXMgPSBjYXRlZ3NDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLmNhdGVnb3J5LWNhcmQnKVxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhdC1tZXRhJykuY2xhc3NOYW1lID0gJ2hpZGRlbidcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aGVtZS1tZXRhJykuY2xhc3NOYW1lID0gJ2hpZGRlbidcblxuY29uc3QgZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcmlsbGRvd24nKTtcblxuLy8gQWRkIHRvZ2dsZSBldm50bGlzdFxudG9nZ2xlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuXHR0aGVtZXNUb2dnbGVkID0gIXRvZ2dsZS5jaGVja2VkO1xuXHRpZiAoIXRoZW1lc1RvZ2dsZWQpIHtcblx0XHR0aGVtZXNDb250YWluZXIuY2xhc3NOYW1lID0gJ3NlbGVjdGVkJztcblx0XHRjYXRlZ3NDb250YWluZXIuY2xhc3NOYW1lID0gJyc7XG5cdH0gZWxzZSB7XG5cdFx0dGhlbWVzQ29udGFpbmVyLmNsYXNzTmFtZSA9ICcnO1xuXHRcdGNhdGVnc0NvbnRhaW5lci5jbGFzc05hbWUgPSAnc2VsZWN0ZWQnO1xuXHR9XG5cblx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhdC1tZXRhJykuY2xhc3NOYW1lID0gJ2hpZGRlbidcblx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RoZW1lLW1ldGEnKS5jbGFzc05hbWUgPSAnaGlkZGVuJ1xuXHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RvcnknKS5jbGFzc05hbWUgPSAnaGlkZGVuJ1xufSlcblxuaWYgKCF0aGVtZXNUb2dnbGVkKSB7XG5cdHRoZW1lc0NvbnRhaW5lci5jbGFzc05hbWUgPSAnc2VsZWN0ZWQnXG5cdGNhdGVnc0NvbnRhaW5lci5jbGFzc05hbWUgPSAnJ1xufSBlbHNlIHtcblx0dGhlbWVzQ29udGFpbmVyLmNsYXNzTmFtZSA9ICcnXG5cdGNhdGVnc0NvbnRhaW5lci5jbGFzc05hbWUgPSAnc2VsZWN0ZWQnXG59XG5cbi8vIGltcGxlbWVudCB0aGUgbG9naWMgb24gZWFjaCBUaGVtZSBpdGVtXG50aGVtZUl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcblx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KClcblx0XHRsZXQgSUQgPSBpdGVtLmdldEF0dHJpYnV0ZSgnZGF0YS10aGVtZScpXG5cblx0XHRpZiAoIXRoZW1lLmlzQ2FjaGVkKElEKSkgeyAvLyBpZiBub3QgY2FjaGVkLCBjaGVjayBvbmxpbmVcblx0XHRcdHRoZW1lLmdldChJRCwgYSwgZGF0YSA9PiB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCdyZXRyaWV2ZWQgbGl2ZSBkYXRhOiBJRCAjJyArIElEKVxuXHRcdFx0XHR0aGVtZS5zZXRET00oZGF0YSwgc3RhdGUsIHN0b3J5LCBhKVxuXHRcdFx0fSlcblx0XHR9IGVsc2Uge1xuXHRcdFx0bGV0IGRhdGEgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0JytJRCkpXG5cdFx0XHRjb25zb2xlLmxvZygncmV0cmlldmVkIGNhY2hlZCBkYXRhOiBJRCAjJyArIElEKVxuXHRcdFx0dGhlbWUuc2V0RE9NKGRhdGEsIHN0YXRlLCBzdG9yeSwgYSlcblx0XHR9XG5cblx0XHR0aGVtZXNDb250YWluZXIuY2xhc3NOYW1lID0gJyc7IC8vIGhpZGUgdGhlbWUgbGlzdFxuXHRcdGQuc2V0QXR0cmlidXRlKCdkYXRhLWFjdGl2ZScsICd0aGVtZScpXG5cblx0fSlcbn0pXG5cbi8vIGltcGxlbWVudCB0aGUgbG9naWMgb24gZWFjaCBDYXRlZ29yeSBJdGVtXG5jYXRlZ0l0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcblx0aXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KClcblx0XHRsZXQgSUQgPSBpdGVtLmdldEF0dHJpYnV0ZSgnZGF0YS1jYXQnKVxuXG5cblx0XHRpZiAoIWNhdGVnLmlzQ2FjaGVkKElEKSkge1xuXHRcdFx0Y2F0ZWcuZ2V0KElELCBhLCBmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRjb25zb2xlLmxvZygncmV0cmlldmVkIGxpdmUgZGF0YTogSUQgIycgKyBJRClcblx0XHRcdFx0c3RhdGUubGV2ZWxzdHJpbmcgPSAnQnkgY2F0ZWdvcnkgPiAnICsgZGF0YS5uYW1lXG5cdFx0XHRcdGNhdGVnLnNldERPTShkYXRhLCBzdGF0ZSwgc3RvcnksIGEpXG5cdFx0XHR9KVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRsZXQgZGF0YSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2MnK0lEKSlcblx0XHRcdGNvbnNvbGUubG9nKCdyZXRyaWV2ZWQgY2FjaGVkIGRhdGE6IElEICMnICsgSUQpXG5cdFx0XHRzdGF0ZS5sZXZlbHN0cmluZyA9ICdCeSBjYXRlZ29yeSA+ICcgKyBkYXRhLm5hbWVcblx0XHRcdGNhdGVnLnNldERPTShkYXRhLCBzdGF0ZSwgc3RvcnksIGEpXG5cdFx0fVxuXHRcdGNhdGVnc0NvbnRhaW5lci5jbGFzc05hbWUgPSAnJztcblx0XHRkLnNldEF0dHJpYnV0ZSgnZGF0YS1hY3RpdmUnLCAnY2F0Jylcblx0fSlcbn0pIiwibW9kdWxlLmV4cG9ydHMgPSB7XG5cdGlzQ2FjaGVkOiBmdW5jdGlvbiAoSUQpIHtcblx0XHRyZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2MnK0lEKSA/IHRydWUgOiBmYWxzZVxuXHR9LFxuXG5cdGNhY2hlOiBmdW5jdGlvbiAoZGF0YSkge1xuXHRcdGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjJyArIGRhdGEuaWQsIEpTT04uc3RyaW5naWZ5KGRhdGEpKVxuXHR9LFxuXG5cdGdldDogZnVuY3Rpb24gKGNhdElELCBheGlvcywgY2FsbGJhY2spIHtcblx0XHRheGlvcy5nZXQoJ2NhdGVnb3JpZXMvJyArIGNhdElEKS50aGVuKCByZXNwb25zZSA9PiB7XG5cdFx0XHR0aGlzLmNhY2hlKHJlc3BvbnNlLmRhdGEpXG5cdFx0XHRjYWxsYmFjayhyZXNwb25zZS5kYXRhKVxuXHRcdH0pLmNhdGNoKCdlcnJvcicsIGZ1bmN0aW9uIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS53YXJuKGVycm9yKVxuXHRcdFx0cmV0dXJuIG51bGxcblx0XHR9KVxuXHR9LFxuXG5cdHNldERPTTogZnVuY3Rpb24gKGNhdCwgc3RhdGUsIHN0b3J5LCBheGlvcykge1xuXHRcdC8vIHNldCB0aGUgZWxlbWVudCB0byB2aXNpYmxlXG5cdFx0Ly9cblx0XHRjb25zdCBjID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhdC1tZXRhJylcblx0XHRzdGF0ZS5kcmlsbExldmVsID0gMSAvLyBub3QgaW1wbGVtZW50ZWRcblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2F0LW1ldGEnKS5jbGFzc05hbWUgPSAnJ1xuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aGVtZS1tZXRhJykuY2xhc3NOYW1lID0gJ2hpZGRlbidcblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RvcnknKS5jbGFzc05hbWUgPSAnaGlkZGVuJ1xuXG5cdFx0Y29uc29sZS5sb2coJ3N0YXRlOiAnLCBzdGF0ZSk7XG5cblx0XHQvLyBzZXQgbWV0YSBkZXNjcmlwdGlvblxuXHRcdGMucXVlcnlTZWxlY3RvckFsbCgnI2NhdC1tZXRhX19oZWFkZXIgaDInKVswXS5pbm5lckhUTUwgPSBjYXQubmFtZVxuXHRcdGMucXVlcnlTZWxlY3RvckFsbCgnI2NhdC1tZXRhX19oZWFkZXIgc3BhbicpWzBdLmlubmVySFRNTCA9IHN0YXRlLmxldmVsc3RyaW5nXG5cdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhdC1tZXRhX19jb250ZW50JykuaW5uZXJIVE1MID0gY2F0LmRlc2NyaXB0aW9uXG5cblx0XHQvLyBzZXQgYXN5bmNcblx0XHRzZXRUaW1lb3V0KCAvLyAgKyAnJmZpZWxkcz1pZCx0aXRsZSxzdG9yaWVzX2Rlc2NyaXB0aW9uJyA6KFxuXHRcdFx0c3RvcnkuZ2V0UmVsYXRlZFN0b3JpZXMoJ3N0b3J5P2NhdGVnb3JpZXM9JyArIGNhdC5pZCwgZnVuY3Rpb24gKHN0b3JpZXMpIHtcblx0XHRcdFx0dmFyIGxpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2F0LW1ldGFfX2xpc3QnKVxuXHRcdFx0XHRsaXN0LmNsYXNzTmFtZSA9ICdpc1JlZnJlc2hpbmcnXG5cdFx0XHRcdGxpc3QuaW5uZXJIVE1MID0gJydcblxuXHRcdFx0XHQvLyBjcmVhdGUgc3RvcnkgcHJldmlld3Ncblx0XHRcdFx0Zm9yICh2YXIgaSA9IHN0b3JpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcblx0XHRcdFx0XHRsZXQgcyA9IHN0b3JpZXNbaV1cblxuXHRcdFx0XHRcdGxldCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG5cdFx0XHRcdFx0ZWwuY2xhc3NOYW1lID0gJ3N0b3J5J1xuXHRcdFx0XHRcdGVsLnNldEF0dHJpYnV0ZSgnZGF0YS1zdG9yeScsIHMuaWQpXG5cdFx0XHRcdFx0ZWwuaW5uZXJIVE1MID0gJzxoMz4nICsgcy50aXRsZS5yZW5kZXJlZCArICc8L2gzPidcblx0XHRcdFx0XHQrICc8cD4nICsgcy5zdG9yaWVzX2Rlc2NyaXB0aW9uICsgJzwvcD4nXG5cdFx0XHRcdFx0KyAnPHAgY2xhc3M9XCJtZXRhXCI+PGI+TGV2ZWw6PC9iPiAnICsgc3RvcnkubGV2ZWwocy5zdG9yeV9sZXZlbCkgKyAnPC9wPic7XG5cblx0XHRcdFx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2F0LW1ldGFfX2xpc3QnKS5hcHBlbmRDaGlsZChlbClcblxuXHRcdFx0XHRcdGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0XHRcdFx0bG9jYXRpb24uaHJlZiA9IHMubGlua1xuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdH1cblx0XHRcdFx0bGlzdC5jbGFzc05hbWUgPSAnJ1xuXHRcdFx0fSwgYXhpb3Ncblx0XHQpLCAwKVxuXG5cdH1cbn0iLCJtb2R1bGUuZXhwb3J0cyA9IHtcblx0Ly8gU3RvcnkgRnVuY3Rpb25zXG5cdGdldFJlbGF0ZWRTdG9yaWVzOiBmdW5jdGlvbiAocXVlcnksIGNhbGxiYWNrLCBheGlvcykge1xuXHRcdGF4aW9zLmdldChxdWVyeSkudGhlbihmdW5jdGlvbihyZXMpIHtcblx0XHRcdGNhbGxiYWNrKHJlcy5kYXRhKVxuXHRcdH0pLmNhdGNoKCdlcnJvcicsIGZ1bmN0aW9uIChlKSB7Y29uc29sZS53YXJuKGUpfSlcblx0fSxcblxuXHRzaG93U3Rvcnk6IGZ1bmN0aW9uIChzdG9yeSwgc3RhdGUpIHtcblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2F0LW1ldGEnKS5jbGFzc05hbWUgPSAnaGlkZGVuJ1xuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aGVtZS1tZXRhJykuY2xhc3NOYW1lID0gJ2hpZGRlbidcblxuXHRcdGNvbnN0IHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RvcnknKVxuXHRcdHMuY2xhc3NOYW1lID0gJydcblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RvcnktdGl0bGUnKS5pbm5lckhUTUwgPSBzdG9yeS50aXRsZS5yZW5kZXJlZFxuXHRcdHMucXVlcnlTZWxlY3RvckFsbCgnaGVhZGVyIHNwYW4nKVswXS5pbm5lckhUTUwgPSBzdGF0ZS5sZXZlbHN0cmluZyArICcgPiAnICsgc3RvcnkudGl0bGUucmVuZGVyZWRcblxuXG5cblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RvcnlfX2JvZHktZGVzYycpLmlubmVySFRNTCA9IHN0b3J5LnN0b3JpZXNfZGVzY3JpcHRpb25cblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RvcnlfX2JvZHktcmVzJykuaW5uZXJIVE1MID0gc3Rvcnkuc3Rvcmllc19yZXNvdXJjZXNcblxuXG5cdFx0Ly8gbGV0IHJlcyA9IFtdXG5cdFx0Ly8gbGV0IHJlc0hUTUwgPSAnPHVsPidcblx0XHQvLyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RvcnlfX2JvZHktbGlua3MnKS5pbm5lckhUTUwgPSBzdG9yeS5yZXNIVE1MXG5cblx0XHRjb25zb2xlLmxvZygnc3Rvcnk6ICcsIHN0b3J5KTtcblx0fSxcblxuXHQvKipcblx0ICogUmV0dXJucyB0aGUgc3RyaWcgYXNzb2NpYXRlZCB3aXRoIGVhY2ggbGV2ZWxcblx0ICogQHBhcmFtICB7aW50fSBpbnQgW3RoZSBzdG9yeSdzIGxldmVsXVxuXHQgKiBAcmV0dXJuIHtzdHJpbmd9ICBbY29ycmVzcG9uZGluZyBsZXZlbF1cblx0ICovXG5cdGxldmVsKGludCkge1xuXHRcdGxldCBpID0gcGFyc2VJbnQoaW50KVxuXHRcdHN3aXRjaChpKSB7XG5cdFx0XHRjYXNlIDE6IHJldHVybiAnQmVnaW5uZXInXG5cdFx0XHRjYXNlIDI6IHJldHVybiAnRWFzeSdcblx0XHRcdGNhc2UgMzogcmV0dXJuICdBdmVyYWdlJ1xuXHRcdFx0Y2FzZSA0OiByZXR1cm4gJ0FkdmFuY2VkJ1xuXHRcdFx0Y2FzZSA1OiByZXR1cm4gJ0V4cGVydCdcblx0XHR9XG5cdH1cbn0iLCJcbi8vIHRoZW1lIGZ1bmN0aW9uc1xubW9kdWxlLmV4cG9ydHMgPSB7XG5cblx0aXNDYWNoZWQ6IGZ1bmN0aW9uIChJRCkge1xuXHRcdHJldHVybiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndCcrSUQpID8gdHJ1ZSA6IGZhbHNlXG5cdH0sXG5cblx0Y2FjaGU6IGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0bG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3QnICsgZGF0YS5pZCwgSlNPTi5zdHJpbmdpZnkoZGF0YSkpXG5cdH0sXG5cblx0Z2V0OiBmdW5jdGlvbiAodGhlbWVJRCwgYXhpb3MsIGNhbGxiYWNrKSB7XG5cdFx0YXhpb3MuZ2V0KCd0YWdzLycgKyB0aGVtZUlEKS50aGVuKCAocmVzcG9uc2UpID0+IHtcblx0XHRcdHRoaXMuY2FjaGUocmVzcG9uc2UuZGF0YSlcblx0XHRcdGNhbGxiYWNrKHJlc3BvbnNlLmRhdGEpXG5cdFx0fSkuY2F0Y2goJ2Vycm9yJywgZnVuY3Rpb24gKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLndhcm4oZXJyb3IpXG5cdFx0XHRyZXR1cm4gbnVsbFxuXHRcdH0pXG5cdH0sXG5cblx0c2V0RE9NOiBmdW5jdGlvbiAodGhlbWUsIHN0YXRlLCBzdG9yeSwgYXhpb3MpIHtcblx0XHQvLyBzZXQgdGhlIGVsZW1lbnQgdG8gdmlzaWJsZVxuXHRcdGNvbnN0IHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGhlbWUtbWV0YScpXG5cdFx0c3RhdGUuZHJpbGxMZXZlbCA9IDEgLy8gbm90IGltcGxlbWVudGVkXG5cdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhdC1tZXRhJykuY2xhc3NOYW1lID0gJ2hpZGRlbidcblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGhlbWUtbWV0YScpLmNsYXNzTmFtZSA9ICcnXG5cdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0b3J5JykuY2xhc3NOYW1lID0gJ2hpZGRlbidcblxuXHRcdC8vIHNldCBtZXRhIGRlc2NyaXB0aW9uXG5cdFx0dC5xdWVyeVNlbGVjdG9yQWxsKCcjdGhlbWUtbWV0YV9faGVhZGVyIGgyJylbMF0uaW5uZXJIVE1MID0gdGhlbWUubmFtZVxuXHRcdHQucXVlcnlTZWxlY3RvckFsbCgnI3RoZW1lLW1ldGFfX2hlYWRlciBzcGFuJylbMF0uaW5uZXJIVE1MID0gc3RhdGUubGV2ZWxzdHJpbmdcblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGhlbWUtbWV0YV9fY29udGVudCcpLmlubmVySFRNTCA9IHRoZW1lLmRlc2NyaXB0aW9uXG5cblx0XHQvLyBzZXQgYXN5bmNcblx0XHRzZXRUaW1lb3V0KCAvLyAgKyAnJmZpZWxkcz1pZCx0aXRsZSxzdG9yaWVzX2Rlc2NyaXB0aW9uJyA6KFxuXHRcdFx0c3RvcnkuZ2V0UmVsYXRlZFN0b3JpZXMoJ3N0b3J5P3RhZ3M9JyArIHRoZW1lLmlkLCBmdW5jdGlvbiAoc3Rvcmllcykge1xuXHRcdFx0XHR2YXIgbGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aGVtZS1tZXRhX19saXN0Jylcblx0XHRcdFx0bGlzdC5jbGFzc05hbWUgPSAnaXNSZWZyZXNoaW5nJ1xuXHRcdFx0XHRsaXN0LmlubmVySFRNTCA9ICcnXG5cblx0XHRcdFx0Ly8gY3JlYXRlIHN0b3J5IHByZXZpZXdzXG5cdFx0XHRcdGZvciAodmFyIGkgPSBzdG9yaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG5cdFx0XHRcdFx0bGV0IHMgPSBzdG9yaWVzW2ldXG5cblx0XHRcdFx0XHRsZXQgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuXHRcdFx0XHRcdGVsLmNsYXNzTmFtZSA9ICdzdG9yeSdcblx0XHRcdFx0XHRlbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3RvcnknLCBzLmlkKVxuXHRcdFx0XHRcdGVsLmlubmVySFRNTCA9ICc8aDM+JyArIHMudGl0bGUucmVuZGVyZWQgKyAnPC9oMz4nXG5cdFx0XHRcdFx0KyAnPHA+JyArIHMuc3Rvcmllc19kZXNjcmlwdGlvbiArICc8L3A+J1xuXHRcdFx0XHRcdCsgJzxwIGNsYXNzPVwibWV0YVwiPjxiPkxldmVsOjwvYj4gJyArIHN0b3J5LmxldmVsKHMuc3RvcnlfbGV2ZWwpICsgJzwvcD4nO1xuXG5cdFx0XHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RoZW1lLW1ldGFfX2xpc3QnKS5hcHBlbmRDaGlsZChlbClcblxuXHRcdFx0XHRcdGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0XHRcdFx0Ly8gc3Rvcnkuc2hvd1N0b3J5KHMsIHN0YXRlKVxuXHRcdFx0XHRcdFx0bG9jYXRpb24uaHJlZiA9IHMubGlua1xuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdH1cblx0XHRcdFx0bGlzdC5jbGFzc05hbWUgPSAnJ1xuXHRcdFx0fSwgYXhpb3Ncblx0XHQpLCAwKVxuXHR9XG59Il19
