(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';

var _theme = require('./util/theme.js');

var _theme2 = _interopRequireDefault(_theme);

var _stories = require('./util/stories.js');

var _stories2 = _interopRequireDefault(_stories);

var _cat = require('./util/cat.js');

var _cat2 = _interopRequireDefault(_cat);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var a = axios.create({
	// baseURL: window._burl // set in HTML via wordpress
	baseURL: 'http://doe.concordia.ca/cslp/wp-json/wp/v2/' // development
});

var toggle = document.getElementById('a');
var themesToggled = !toggle.checked;

// app state
var state = {};
state.drillLevel = 0;
state.active = 'none';
state.levelstring = '';
state.themeID = null; // for further caching. Implement later!
state.backone = function () {
	this.drillLevel -= 1;
	console.log('state.drillLevel: ', state.drillLevel);
};
state.hidemeta = function () {
	document.querySelectorAll('.stories-meta')[0].className = 'stories-meta hidden';
};

var themesContainer = document.getElementById('stories__by-theme');
var categsContainer = document.getElementById('stories__by-cat');
var themeItems = themesContainer.querySelectorAll('.theme-card');
var categItems = categsContainer.querySelectorAll('.category-card');
document.getElementById('cat-meta').className = 'hidden';
document.getElementById('theme-meta').className = 'hidden';

var d = document.getElementById('drilldown');

// Add toggle evntlist
toggle.addEventListener('click', function () {
	themesToggled = !toggle.checked;
	if (!themesToggled) {
		themesContainer.className = 'selected';
		categsContainer.className = '';
	} else {
		themesContainer.className = '';
		categsContainer.className = 'selected';
	}

	document.getElementById('cat-meta').className = 'hidden';
	document.getElementById('theme-meta').className = 'hidden';
	document.getElementById('story').className = 'hidden';
});

if (!themesToggled) {
	themesContainer.className = 'selected';
	categsContainer.className = '';
} else {
	themesContainer.className = '';
	categsContainer.className = 'selected';
}

// implement the logic on each Theme item
themeItems.forEach(function (item) {
	item.addEventListener('click', function (e) {
		e.preventDefault();
		var ID = item.getAttribute('data-theme');

		if (!_theme2.default.isCached(ID)) {
			// if not cached, check online
			_theme2.default.get(ID, a, function (data) {
				console.log('retrieved live data: ID #' + ID);
				_theme2.default.setDOM(data, state, _stories2.default, a);
			});
		} else {
			var data = JSON.parse(localStorage.getItem('t' + ID));
			console.log('retrieved cached data: ID #' + ID);
			_theme2.default.setDOM(data, state, _stories2.default, a);
		}

		themesContainer.className = ''; // hide theme list
		d.setAttribute('data-active', 'theme');
	});
});

// implement the logic on each Category Item
categItems.forEach(function (item) {
	item.addEventListener('click', function (e) {
		e.preventDefault();
		var ID = item.getAttribute('data-cat');

		if (!_cat2.default.isCached(ID)) {
			_cat2.default.get(ID, a, function (data) {
				console.log('retrieved live data: ID #' + ID);
				state.levelstring = 'By category > ' + data.name;
				_cat2.default.setDOM(data, state, _stories2.default, a);
			});
		} else {
			var data = JSON.parse(localStorage.getItem('c' + ID));
			console.log('retrieved cached data: ID #' + ID);
			state.levelstring = 'By category > ' + data.name;
			_cat2.default.setDOM(data, state, _stories2.default, a);
		}
		categsContainer.className = '';
		d.setAttribute('data-active', 'cat');
	});
});

},{"./util/cat.js":2,"./util/stories.js":3,"./util/theme.js":4}],2:[function(require,module,exports){
'use strict';

module.exports = {
	isCached: function isCached(ID) {
		return localStorage.getItem('c' + ID) ? true : false;
	},

	cache: function cache(data) {
		localStorage.setItem('c' + data.id, JSON.stringify(data));
	},

	get: function get(catID, axios, callback) {
		var _this = this;

		axios.get('categories/' + catID).then(function (response) {
			_this.cache(response.data);
			callback(response.data);
		}).catch('error', function (error) {
			console.warn(error);
			return null;
		});
	},

	setDOM: function setDOM(cat, state, story, axios) {
		// set the element to visible
		//
		var c = document.getElementById('cat-meta');
		state.drillLevel = 1; // not implemented
		document.getElementById('cat-meta').className = '';
		document.getElementById('theme-meta').className = 'hidden';
		document.getElementById('story').className = 'hidden';

		console.log('state: ', state);

		// set meta description
		c.querySelectorAll('#cat-meta__header h2')[0].innerHTML = cat.name;
		c.querySelectorAll('#cat-meta__header span')[0].innerHTML = state.levelstring;
		document.getElementById('cat-meta__content').innerHTML = cat.description;

		// set async
		setTimeout( //  + '&fields=id,title,stories_description' :(
		story.getRelatedStories('story?categories=' + cat.id, function (stories) {
			var list = document.getElementById('cat-meta__list');
			list.className = 'isRefreshing';
			list.innerHTML = '';

			// create story previews

			var _loop = function _loop() {
				var s = stories[i];

				var el = document.createElement('div');
				el.className = 'story';
				el.setAttribute('data-story', s.id);
				el.innerHTML = '<h3>' + s.title.rendered + '</h3>' + '<p>' + s.stories_description + '</p>' + '<p class="meta"><b>Level:</b> ' + story.level(s.story_level) + '</p>';

				document.getElementById('cat-meta__list').appendChild(el);

				el.addEventListener('click', function () {
					story.showStory(s, state);
				});
			};

			for (var i = stories.length - 1; i >= 0; i--) {
				_loop();
			}
			list.className = '';
		}, axios), 0);
	}
};

},{}],3:[function(require,module,exports){
'use strict';

module.exports = {
	// Story Functions
	getRelatedStories: function getRelatedStories(query, callback, axios) {
		axios.get(query).then(function (res) {
			callback(res.data);
		}).catch('error', function (e) {
			console.warn(e);
		});
	},

	showStory: function showStory(story, state) {
		document.getElementById('cat-meta').className = 'hidden';
		document.getElementById('theme-meta').className = 'hidden';

		var s = document.getElementById('story');
		s.className = '';
		document.getElementById('story-title').innerHTML = story.title.rendered;
		s.querySelectorAll('header span')[0].innerHTML = state.levelstring + ' > ' + story.title.rendered;

		document.getElementById('story__body-desc').innerHTML = story.stories_description;
		document.getElementById('story__body-res').innerHTML = story.stories_resources;

		// let res = []
		// let resHTML = '<ul>'
		// document.getElementById('story__body-links').innerHTML = story.resHTML

		console.log('story: ', story);
	},

	/**
  * Returns the strig associated with each level
  * @param  {int} int [the story's level]
  * @return {string}  [corresponding level]
  */
	level: function level(int) {
		var i = parseInt(int);
		switch (i) {
			case 1:
				return 'Beginner';
			case 2:
				return 'Easy';
			case 3:
				return 'Average';
			case 4:
				return 'Advanced';
			case 5:
				return 'Expert';
		}
	}
};

},{}],4:[function(require,module,exports){
'use strict';

// theme functions
module.exports = {

	isCached: function isCached(ID) {
		return localStorage.getItem('t' + ID) ? true : false;
	},

	cache: function cache(data) {
		localStorage.setItem('t' + data.id, JSON.stringify(data));
	},

	get: function get(themeID, axios, callback) {
		var _this = this;

		axios.get('tags/' + themeID).then(function (response) {
			_this.cache(response.data);
			callback(response.data);
		}).catch('error', function (error) {
			console.warn(error);
			return null;
		});
	},

	setDOM: function setDOM(theme, state, story, axios) {
		// set the element to visible
		var t = document.getElementById('theme-meta');
		state.drillLevel = 1; // not implemented
		document.getElementById('cat-meta').className = 'hidden';
		document.getElementById('theme-meta').className = '';
		document.getElementById('story').className = 'hidden';

		// set meta description
		t.querySelectorAll('#theme-meta__header h2')[0].innerHTML = theme.name;
		t.querySelectorAll('#theme-meta__header span')[0].innerHTML = state.levelstring;
		document.getElementById('theme-meta__content').innerHTML = theme.description;

		// set async
		setTimeout( //  + '&fields=id,title,stories_description' :(
		story.getRelatedStories('story?tags=' + theme.id, function (stories) {
			var list = document.getElementById('theme-meta__list');
			list.className = 'isRefreshing';
			list.innerHTML = '';

			// create story previews

			var _loop = function _loop() {
				var s = stories[i];

				var el = document.createElement('div');
				el.className = 'story';
				el.setAttribute('data-story', s.id);
				el.innerHTML = '<h3>' + s.title.rendered + '</h3>' + '<p>' + s.stories_description + '</p>' + '<p class="meta"><b>Level:</b> ' + story.level(s.story_level) + '</p>';

				document.getElementById('theme-meta__list').appendChild(el);

				el.addEventListener('click', function () {
					story.showStory(s, state);
				});
			};

			for (var i = stories.length - 1; i >= 0; i--) {
				_loop();
			}
			list.className = '';
		}, axios), 0);
	}
};

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvc2NyaXB0cy9zdG9yaWVzL3N0b3JpZXMuanMiLCJzcmMvc2NyaXB0cy9zdG9yaWVzL3V0aWwvY2F0LmpzIiwic3JjL3NjcmlwdHMvc3Rvcmllcy91dGlsL3N0b3JpZXMuanMiLCJzcmMvc2NyaXB0cy9zdG9yaWVzL3V0aWwvdGhlbWUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTs7QUFFQTs7OztBQUNBOzs7O0FBQ0E7Ozs7OztBQUVBLElBQU0sSUFBSSxNQUFNLE1BQU4sQ0FBYTtBQUN0QjtBQUNBLFVBQVMsNkNBRmEsQ0FFaUM7QUFGakMsQ0FBYixDQUFWOztBQUtBLElBQU0sU0FBUyxTQUFTLGNBQVQsQ0FBd0IsR0FBeEIsQ0FBZjtBQUNBLElBQUksZ0JBQWdCLENBQUMsT0FBTyxPQUE1Qjs7QUFFQTtBQUNBLElBQU0sUUFBUSxFQUFkO0FBQ0EsTUFBTSxVQUFOLEdBQW1CLENBQW5CO0FBQ0EsTUFBTSxNQUFOLEdBQWUsTUFBZjtBQUNBLE1BQU0sV0FBTixHQUFvQixFQUFwQjtBQUNBLE1BQU0sT0FBTixHQUFnQixJQUFoQixDLENBQXFCO0FBQ3JCLE1BQU0sT0FBTixHQUFnQixZQUFZO0FBQzNCLE1BQUssVUFBTCxJQUFtQixDQUFuQjtBQUNBLFNBQVEsR0FBUixDQUFZLG9CQUFaLEVBQWtDLE1BQU0sVUFBeEM7QUFDQSxDQUhEO0FBSUEsTUFBTSxRQUFOLEdBQWlCLFlBQVk7QUFDNUIsVUFBUyxnQkFBVCxDQUEwQixlQUExQixFQUEyQyxDQUEzQyxFQUE4QyxTQUE5QyxHQUEwRCxxQkFBMUQ7QUFDQSxDQUZEOztBQUlBLElBQU0sa0JBQWtCLFNBQVMsY0FBVCxDQUF3QixtQkFBeEIsQ0FBeEI7QUFDQSxJQUFNLGtCQUFrQixTQUFTLGNBQVQsQ0FBd0IsaUJBQXhCLENBQXhCO0FBQ0EsSUFBTSxhQUFhLGdCQUFnQixnQkFBaEIsQ0FBaUMsYUFBakMs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U0FBTCxHQUFpQixFQUFqQjs7QUFFQTs7QUFMb0U7QUFPbkUsUUFBSSxJQUFJLFFBQVEsQ0FBUixDQUFSOztBQUVBLFFBQUksS0FBSyxTQUFTLGFBQVQsQ0FBdUIsS0FBdkIsQ0FBVDtBQUNBLE9BQUcsU0FBSCxHQUFlLE9BQWY7QUFDQSxPQUFHLFlBQUgsQ0FBZ0IsWUFBaEIsRUFBOEIsRUFBRSxFQUFoQztBQUNBLE9BQUcsU0FBSCxHQUFlLFNBQVMsRUFBRSxLQUFGLENBQVEsUUFBakIsR0FBNEIsT0FBNUIsR0FDYixLQURhLEdBQ0wsRUFBRSxtQkFERyxHQUNtQixNQURuQixHQUViLGdDQUZhLEdBRXNCLE1BQU0sS0FBTixDQUFZLEVBQUUsV0FBZCxDQUZ0QixHQUVtRCxNQUZsRTs7QUFJQSxhQUFTLGNBQVQsQ0FBd0Isa0JBQXhCLEVBQTRDLFdBQTVDLENBQXdELEVBQXhEOztBQUVBLE9BQUcsZ0JBQUgsQ0FBb0IsT0FBcEIsRUFBNkIsWUFBTTtBQUNsQyxXQUFNLFNBQU4sQ0FBZ0IsQ0FBaEIsRUFBbUIsS0FBbkI7QUFDQSxLQUZEO0FBbEJtRTs7QUFNcEUsUUFBSyxJQUFJLElBQUksUUFBUSxNQUFSLEdBQWlCLENBQTlCLEVBQWlDLEtBQUssQ0FBdEMsRUFBeUMsR0FBekMsRUFBOEM7QUFBQTtBQWU3QztBQUNELFFBQUssU0FBTCxHQUFpQixFQUFqQjtBQUNBLEdBdkJELEVBdUJHLEtBdkJILENBREQsRUF5QkcsQ0F6Qkg7QUEwQkE7QUE1RGUsQ0FBakIiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCIndXNlIHN0cmljdCc7XG5cbmltcG9ydCB0aGVtZSBmcm9tICcuL3V0aWwvdGhlbWUuanMnXG5pbXBvcnQgc3RvcnkgZnJvbSAnLi91dGlsL3N0b3JpZXMuanMnXG5pbXBvcnQgY2F0ZWcgZnJvbSAnLi91dGlsL2NhdC5qcydcblxuY29uc3QgYSA9IGF4aW9zLmNyZWF0ZSh7XG5cdC8vIGJhc2VVUkw6IHdpbmRvdy5fYnVybCAvLyBzZXQgaW4gSFRNTCB2aWEgd29yZHByZXNzXG5cdGJhc2VVUkw6ICdodHRwOi8vZG9lLmNvbmNvcmRpYS5jYS9jc2xwL3dwLWpzb24vd3AvdjIvJyAvLyBkZXZlbG9wbWVudFxufSlcblxuY29uc3QgdG9nZ2xlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2EnKVxubGV0IHRoZW1lc1RvZ2dsZWQgPSAhdG9nZ2xlLmNoZWNrZWRcblxuLy8gYXBwIHN0YXRlXG5jb25zdCBzdGF0ZSA9IHt9XG5zdGF0ZS5kcmlsbExldmVsID0gMFxuc3RhdGUuYWN0aXZlID0gJ25vbmUnXG5zdGF0ZS5sZXZlbHN0cmluZyA9ICcnXG5zdGF0ZS50aGVtZUlEID0gbnVsbCAvLyBmb3IgZnVydGhlciBjYWNoaW5nLiBJbXBsZW1lbnQgbGF0ZXIhXG5zdGF0ZS5iYWNrb25lID0gZnVuY3Rpb24gKCkge1xuXHR0aGlzLmRyaWxsTGV2ZWwgLT0gMVxuXHRjb25zb2xlLmxvZygnc3RhdGUuZHJpbGxMZXZlbDogJywgc3RhdGUuZHJpbGxMZXZlbClcbn1cbnN0YXRlLmhpZGVtZXRhID0gZnVuY3Rpb24gKCkge1xuXHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc3Rvcmllcy1tZXRhJylbMF0uY2xhc3NOYW1lID0gJ3N0b3JpZXMtbWV0YSBoaWRkZW4nXG59XG5cbmNvbnN0IHRoZW1lc0NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdG9yaWVzX19ieS10aGVtZScpXG5jb25zdCBjYXRlZ3NDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3Rvcmllc19fYnktY2F0JylcbmNvbnN0IHRoZW1lSXRlbXMgPSB0aGVtZXNDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLnRoZW1lLWNhcmQnKVxuY29uc3QgY2F0ZWdJdGVtcyA9IGNhdGVnc0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuY2F0ZWdvcnktY2FyZCcpXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2F0LW1ldGEnKS5jbGFzc05hbWUgPSAnaGlkZGVuJ1xuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RoZW1lLW1ldGEnKS5jbGFzc05hbWUgPSAnaGlkZGVuJ1xuXG5jb25zdCBkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RyaWxsZG93bicpO1xuXG4vLyBBZGQgdG9nZ2xlIGV2bnRsaXN0XG50b2dnbGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG5cdHRoZW1lc1RvZ2dsZWQgPSAhdG9nZ2xlLmNoZWNrZWQ7XG5cdGlmICghdGhlbWVzVG9nZ2xlZCkge1xuXHRcdHRoZW1lc0NvbnRhaW5lci5jbGFzc05hbWUgPSAnc2VsZWN0ZWQnO1xuXHRcdGNhdGVnc0NvbnRhaW5lci5jbGFzc05hbWUgPSAnJztcblx0fSBlbHNlIHtcblx0XHR0aGVtZXNDb250YWluZXIuY2xhc3NOYW1lID0gJyc7XG5cdFx0Y2F0ZWdzQ29udGFpbmVyLmNsYXNzTmFtZSA9ICdzZWxlY3RlZCc7XG5cdH1cblxuXHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2F0LW1ldGEnKS5jbGFzc05hbWUgPSAnaGlkZGVuJ1xuXHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGhlbWUtbWV0YScpLmNsYXNzTmFtZSA9ICdoaWRkZW4nXG5cdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdG9yeScpLmNsYXNzTmFtZSA9ICdoaWRkZW4nXG59KVxuXG5pZiAoIXRoZW1lc1RvZ2dsZWQpIHtcblx0dGhlbWVzQ29udGFpbmVyLmNsYXNzTmFtZSA9ICdzZWxlY3RlZCdcblx0Y2F0ZWdzQ29udGFpbmVyLmNsYXNzTmFtZSA9ICcnXG59IGVsc2Uge1xuXHR0aGVtZXNDb250YWluZXIuY2xhc3NOYW1lID0gJydcblx0Y2F0ZWdzQ29udGFpbmVyLmNsYXNzTmFtZSA9ICdzZWxlY3RlZCdcbn1cblxuLy8gaW1wbGVtZW50IHRoZSBsb2dpYyBvbiBlYWNoIFRoZW1lIGl0ZW1cbnRoZW1lSXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuXHRpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKVxuXHRcdGxldCBJRCA9IGl0ZW0uZ2V0QXR0cmlidXRlKCdkYXRhLXRoZW1lJylcblxuXHRcdGlmICghdGhlbWUuaXNDYWNoZWQoSUQpKSB7IC8vIGlmIG5vdCBjYWNoZWQsIGNoZWNrIG9ubGluZVxuXHRcdFx0dGhlbWUuZ2V0KElELCBhLCBkYXRhID0+IHtcblx0XHRcdFx0Y29uc29sZS5sb2coJ3JldHJpZXZlZCBsaXZlIGRhdGE6IElEICMnICsgSUQpXG5cdFx0XHRcdHRoZW1lLnNldERPTShkYXRhLCBzdGF0ZSwgc3RvcnksIGEpXG5cdFx0XHR9KVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRsZXQgZGF0YSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3QnK0lEKSlcblx0XHRcdGNvbnNvbGUubG9nKCdyZXRyaWV2ZWQgY2FjaGVkIGRhdGE6IElEICMnICsgSUQpXG5cdFx0XHR0aGVtZS5zZXRET00oZGF0YSwgc3RhdGUsIHN0b3J5LCBhKVxuXHRcdH1cblxuXHRcdHRoZW1lc0NvbnRhaW5lci5jbGFzc05hbWUgPSAnJzsgLy8gaGlkZSB0aGVtZSBsaXN0XG5cdFx0ZC5zZXRBdHRyaWJ1dGUoJ2RhdGEtYWN0aXZlJywgJ3RoZW1lJylcblxuXHR9KVxufSlcblxuLy8gaW1wbGVtZW50IHRoZSBsb2dpYyBvbiBlYWNoIENhdGVnb3J5IEl0ZW1cbmNhdGVnSXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuXHRpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKVxuXHRcdGxldCBJRCA9IGl0ZW0uZ2V0QXR0cmlidXRlKCdkYXRhLWNhdCcpXG5cblxuXHRcdGlmICghY2F0ZWcuaXNDYWNoZWQoSUQpKSB7XG5cdFx0XHRjYXRlZy5nZXQoSUQsIGEsIGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCdyZXRyaWV2ZWQgbGl2ZSBkYXRhOiBJRCAjJyArIElEKVxuXHRcdFx0XHRzdGF0ZS5sZXZlbHN0cmluZyA9ICdCeSBjYXRlZ29yeSA+ICcgKyBkYXRhLm5hbWVcblx0XHRcdFx0Y2F0ZWcuc2V0RE9NKGRhdGEsIHN0YXRlLCBzdG9yeSwgYSlcblx0XHRcdH0pXG5cdFx0fSBlbHNlIHtcblx0XHRcdGxldCBkYXRhID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYycrSUQpKVxuXHRcdFx0Y29uc29sZS5sb2coJ3JldHJpZXZlZCBjYWNoZWQgZGF0YTogSUQgIycgKyBJRClcblx0XHRcdHN0YXRlLmxldmVsc3RyaW5nID0gJ0J5IGNhdGVnb3J5ID4gJyArIGRhdGEubmFtZVxuXHRcdFx0Y2F0ZWcuc2V0RE9NKGRhdGEsIHN0YXRlLCBzdG9yeSwgYSlcblx0XHR9XG5cdFx0Y2F0ZWdzQ29udGFpbmVyLmNsYXNzTmFtZSA9ICcnO1xuXHRcdGQuc2V0QXR0cmlidXRlKCdkYXRhLWFjdGl2ZScsICdjYXQnKVxuXHR9KVxufSkiLCJtb2R1bGUuZXhwb3J0cyA9IHtcblx0aXNDYWNoZWQ6IGZ1bmN0aW9uIChJRCkge1xuXHRcdHJldHVybiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYycrSUQpID8gdHJ1ZSA6IGZhbHNlXG5cdH0sXG5cblx0Y2FjaGU6IGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0bG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2MnICsgZGF0YS5pZCwgSlNPTi5zdHJpbmdpZnkoZGF0YSkpXG5cdH0sXG5cblx0Z2V0OiBmdW5jdGlvbiAoY2F0SUQsIGF4aW9zLCBjYWxsYmFjaykge1xuXHRcdGF4aW9zLmdldCgnY2F0ZWdvcmllcy8nICsgY2F0SUQpLnRoZW4oIHJlc3BvbnNlID0+IHtcblx0XHRcdHRoaXMuY2FjaGUocmVzcG9uc2UuZGF0YSlcblx0XHRcdGNhbGxiYWNrKHJlc3BvbnNlLmRhdGEpXG5cdFx0fSkuY2F0Y2goJ2Vycm9yJywgZnVuY3Rpb24gKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLndhcm4oZXJyb3IpXG5cdFx0XHRyZXR1cm4gbnVsbFxuXHRcdH0pXG5cdH0sXG5cblx0c2V0RE9NOiBmdW5jdGlvbiAoY2F0LCBzdGF0ZSwgc3RvcnksIGF4aW9zKSB7XG5cdFx0Ly8gc2V0IHRoZSBlbGVtZW50IHRvIHZpc2libGVcblx0XHQvL1xuXHRcdGNvbnN0IGMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2F0LW1ldGEnKVxuXHRcdHN0YXRlLmRyaWxsTGV2ZWwgPSAxIC8vIG5vdCBpbXBsZW1lbnRlZFxuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYXQtbWV0YScpLmNsYXNzTmFtZSA9ICcnXG5cdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RoZW1lLW1ldGEnKS5jbGFzc05hbWUgPSAnaGlkZGVuJ1xuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdG9yeScpLmNsYXNzTmFtZSA9ICdoaWRkZW4nXG5cblx0XHRjb25zb2xlLmxvZygnc3RhdGU6ICcsIHN0YXRlKTtcblxuXHRcdC8vIHNldCBtZXRhIGRlc2NyaXB0aW9uXG5cdFx0Yy5xdWVyeVNlbGVjdG9yQWxsKCcjY2F0LW1ldGFfX2hlYWRlciBoMicpWzBdLmlubmVySFRNTCA9IGNhdC5uYW1lXG5cdFx0Yy5xdWVyeVNlbGVjdG9yQWxsKCcjY2F0LW1ldGFfX2hlYWRlciBzcGFuJylbMF0uaW5uZXJIVE1MID0gc3RhdGUubGV2ZWxzdHJpbmdcblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2F0LW1ldGFfX2NvbnRlbnQnKS5pbm5lckhUTUwgPSBjYXQuZGVzY3JpcHRpb25cblxuXHRcdC8vIHNldCBhc3luY1xuXHRcdHNldFRpbWVvdXQoIC8vICArICcmZmllbGRzPWlkLHRpdGxlLHN0b3JpZXNfZGVzY3JpcHRpb24nIDooXG5cdFx0XHRzdG9yeS5nZXRSZWxhdGVkU3Rvcmllcygnc3Rvcnk/Y2F0ZWdvcmllcz0nICsgY2F0LmlkLCBmdW5jdGlvbiAoc3Rvcmllcykge1xuXHRcdFx0XHR2YXIgbGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYXQtbWV0YV9fbGlzdCcpXG5cdFx0XHRcdGxpc3QuY2xhc3NOYW1lID0gJ2lzUmVmcmVzaGluZydcblx0XHRcdFx0bGlzdC5pbm5lckhUTUwgPSAnJ1xuXG5cdFx0XHRcdC8vIGNyZWF0ZSBzdG9yeSBwcmV2aWV3c1xuXHRcdFx0XHRmb3IgKHZhciBpID0gc3Rvcmllcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuXHRcdFx0XHRcdGxldCBzID0gc3Rvcmllc1tpXVxuXG5cdFx0XHRcdFx0bGV0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jylcblx0XHRcdFx0XHRlbC5jbGFzc05hbWUgPSAnc3RvcnknXG5cdFx0XHRcdFx0ZWwuc2V0QXR0cmlidXRlKCdkYXRhLXN0b3J5Jywgcy5pZClcblx0XHRcdFx0XHRlbC5pbm5lckhUTUwgPSAnPGgzPicgKyBzLnRpdGxlLnJlbmRlcmVkICsgJzwvaDM+J1xuXHRcdFx0XHRcdCsgJzxwPicgKyBzLnN0b3JpZXNfZGVzY3JpcHRpb24gKyAnPC9wPidcblx0XHRcdFx0XHQrICc8cCBjbGFzcz1cIm1ldGFcIj48Yj5MZXZlbDo8L2I+ICcgKyBzdG9yeS5sZXZlbChzLnN0b3J5X2xldmVsKSArICc8L3A+JztcblxuXHRcdFx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYXQtbWV0YV9fbGlzdCcpLmFwcGVuZENoaWxkKGVsKVxuXG5cdFx0XHRcdFx0ZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHRcdFx0XHRzdG9yeS5zaG93U3Rvcnkocywgc3RhdGUpXG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0fVxuXHRcdFx0XHRsaXN0LmNsYXNzTmFtZSA9ICcnXG5cdFx0XHR9LCBheGlvc1xuXHRcdCksIDApXG5cblx0fVxufSIsIm1vZHVsZS5leHBvcnRzID0ge1xuXHQvLyBTdG9yeSBGdW5jdGlvbnNcblx0Z2V0UmVsYXRlZFN0b3JpZXM6IGZ1bmN0aW9uIChxdWVyeSwgY2FsbGJhY2ssIGF4aW9zKSB7XG5cdFx0YXhpb3MuZ2V0KHF1ZXJ5KS50aGVuKGZ1bmN0aW9uKHJlcykge1xuXHRcdFx0Y2FsbGJhY2socmVzLmRhdGEpXG5cdFx0fSkuY2F0Y2goJ2Vycm9yJywgZnVuY3Rpb24gKGUpIHtjb25zb2xlLndhcm4oZSl9KVxuXHR9LFxuXG5cdHNob3dTdG9yeTogZnVuY3Rpb24gKHN0b3J5LCBzdGF0ZSkge1xuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYXQtbWV0YScpLmNsYXNzTmFtZSA9ICdoaWRkZW4nXG5cdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RoZW1lLW1ldGEnKS5jbGFzc05hbWUgPSAnaGlkZGVuJ1xuXG5cdFx0Y29uc3QgcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdG9yeScpXG5cdFx0cy5jbGFzc05hbWUgPSAnJ1xuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdG9yeS10aXRsZScpLmlubmVySFRNTCA9IHN0b3J5LnRpdGxlLnJlbmRlcmVkXG5cdFx0cy5xdWVyeVNlbGVjdG9yQWxsKCdoZWFkZXIgc3BhbicpWzBdLmlubmVySFRNTCA9IHN0YXRlLmxldmVsc3RyaW5nICsgJyA+ICcgKyBzdG9yeS50aXRsZS5yZW5kZXJlZFxuXG5cblxuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdG9yeV9fYm9keS1kZXNjJykuaW5uZXJIVE1MID0gc3Rvcnkuc3Rvcmllc19kZXNjcmlwdGlvblxuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdG9yeV9fYm9keS1yZXMnKS5pbm5lckhUTUwgPSBzdG9yeS5zdG9yaWVzX3Jlc291cmNlc1xuXG5cblx0XHQvLyBsZXQgcmVzID0gW11cblx0XHQvLyBsZXQgcmVzSFRNTCA9ICc8dWw+J1xuXHRcdC8vIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdG9yeV9fYm9keS1saW5rcycpLmlubmVySFRNTCA9IHN0b3J5LnJlc0hUTUxcblxuXHRcdGNvbnNvbGUubG9nKCdzdG9yeTogJywgc3RvcnkpO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBSZXR1cm5zIHRoZSBzdHJpZyBhc3NvY2lhdGVkIHdpdGggZWFjaCBsZXZlbFxuXHQgKiBAcGFyYW0gIHtpbnR9IGludCBbdGhlIHN0b3J5J3MgbGV2ZWxdXG5cdCAqIEByZXR1cm4ge3N0cmluZ30gIFtjb3JyZXNwb25kaW5nIGxldmVsXVxuXHQgKi9cblx0bGV2ZWwoaW50KSB7XG5cdFx0bGV0IGkgPSBwYXJzZUludChpbnQpXG5cdFx0c3dpdGNoKGkpIHtcblx0XHRcdGNhc2UgMTogcmV0dXJuICdCZWdpbm5lcidcblx0XHRcdGNhc2UgMjogcmV0dXJuICdFYXN5J1xuXHRcdFx0Y2FzZSAzOiByZXR1cm4gJ0F2ZXJhZ2UnXG5cdFx0XHRjYXNlIDQ6IHJldHVybiAnQWR2YW5jZWQnXG5cdFx0XHRjYXNlIDU6IHJldHVybiAnRXhwZXJ0J1xuXHRcdH1cblx0fVxufSIsIlxuLy8gdGhlbWUgZnVuY3Rpb25zXG5tb2R1bGUuZXhwb3J0cyA9IHtcblxuXHRpc0NhY2hlZDogZnVuY3Rpb24gKElEKSB7XG5cdFx0cmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0JytJRCkgPyB0cnVlIDogZmFsc2Vcblx0fSxcblxuXHRjYWNoZTogZnVuY3Rpb24gKGRhdGEpIHtcblx0XHRsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndCcgKyBkYXRhLmlkLCBKU09OLnN0cmluZ2lmeShkYXRhKSlcblx0fSxcblxuXHRnZXQ6IGZ1bmN0aW9uICh0aGVtZUlELCBheGlvcywgY2FsbGJhY2spIHtcblx0XHRheGlvcy5nZXQoJ3RhZ3MvJyArIHRoZW1lSUQpLnRoZW4oIChyZXNwb25zZSkgPT4ge1xuXHRcdFx0dGhpcy5jYWNoZShyZXNwb25zZS5kYXRhKVxuXHRcdFx0Y2FsbGJhY2socmVzcG9uc2UuZGF0YSlcblx0XHR9KS5jYXRjaCgnZXJyb3InLCBmdW5jdGlvbiAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUud2FybihlcnJvcilcblx0XHRcdHJldHVybiBudWxsXG5cdFx0fSlcblx0fSxcblxuXHRzZXRET006IGZ1bmN0aW9uICh0aGVtZSwgc3RhdGUsIHN0b3J5LCBheGlvcykge1xuXHRcdC8vIHNldCB0aGUgZWxlbWVudCB0byB2aXNpYmxlXG5cdFx0Y29uc3QgdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aGVtZS1tZXRhJylcblx0XHRzdGF0ZS5kcmlsbExldmVsID0gMSAvLyBub3QgaW1wbGVtZW50ZWRcblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2F0LW1ldGEnKS5jbGFzc05hbWUgPSAnaGlkZGVuJ1xuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aGVtZS1tZXRhJykuY2xhc3NOYW1lID0gJydcblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RvcnknKS5jbGFzc05hbWUgPSAnaGlkZGVuJ1xuXG5cdFx0Ly8gc2V0IG1ldGEgZGVzY3JpcHRpb25cblx0XHR0LnF1ZXJ5U2VsZWN0b3JBbGwoJyN0aGVtZS1tZXRhX19oZWFkZXIgaDInKVswXS5pbm5lckhUTUwgPSB0aGVtZS5uYW1lXG5cdFx0dC5xdWVyeVNlbGVjdG9yQWxsKCcjdGhlbWUtbWV0YV9faGVhZGVyIHNwYW4nKVswXS5pbm5lckhUTUwgPSBzdGF0ZS5sZXZlbHN0cmluZ1xuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aGVtZS1tZXRhX19jb250ZW50JykuaW5uZXJIVE1MID0gdGhlbWUuZGVzY3JpcHRpb25cblxuXHRcdC8vIHNldCBhc3luY1xuXHRcdHNldFRpbWVvdXQoIC8vICArICcmZmllbGRzPWlkLHRpdGxlLHN0b3JpZXNfZGVzY3JpcHRpb24nIDooXG5cdFx0XHRzdG9yeS5nZXRSZWxhdGVkU3Rvcmllcygnc3Rvcnk/dGFncz0nICsgdGhlbWUuaWQsIGZ1bmN0aW9uIChzdG9yaWVzKSB7XG5cdFx0XHRcdHZhciBsaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RoZW1lLW1ldGFfX2xpc3QnKVxuXHRcdFx0XHRsaXN0LmNsYXNzTmFtZSA9ICdpc1JlZnJlc2hpbmcnXG5cdFx0XHRcdGxpc3QuaW5uZXJIVE1MID0gJydcblxuXHRcdFx0XHQvLyBjcmVhdGUgc3RvcnkgcHJldmlld3Ncblx0XHRcdFx0Zm9yICh2YXIgaSA9IHN0b3JpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcblx0XHRcdFx0XHRsZXQgcyA9IHN0b3JpZXNbaV1cblxuXHRcdFx0XHRcdGxldCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG5cdFx0XHRcdFx0ZWwuY2xhc3NOYW1lID0gJ3N0b3J5J1xuXHRcdFx0XHRcdGVsLnNldEF0dHJpYnV0ZSgnZGF0YS1zdG9yeScsIHMuaWQpXG5cdFx0XHRcdFx0ZWwuaW5uZXJIVE1MID0gJzxoMz4nICsgcy50aXRsZS5yZW5kZXJlZCArICc8L2gzPidcblx0XHRcdFx0XHQrICc8cD4nICsgcy5zdG9yaWVzX2Rlc2NyaXB0aW9uICsgJzwvcD4nXG5cdFx0XHRcdFx0KyAnPHAgY2xhc3M9XCJtZXRhXCI+PGI+TGV2ZWw6PC9iPiAnICsgc3RvcnkubGV2ZWwocy5zdG9yeV9sZXZlbCkgKyAnPC9wPic7XG5cblx0XHRcdFx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGhlbWUtbWV0YV9fbGlzdCcpLmFwcGVuZENoaWxkKGVsKVxuXG5cdFx0XHRcdFx0ZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHRcdFx0XHRzdG9yeS5zaG93U3Rvcnkocywgc3RhdGUpXG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0fVxuXHRcdFx0XHRsaXN0LmNsYXNzTmFtZSA9ICcnXG5cdFx0XHR9LCBheGlvc1xuXHRcdCksIDApXG5cdH1cbn0iXX0=
